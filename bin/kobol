#!/usr/bin/env bash

set -e -o pipefail

[[ -z "$PEARL_ROOT" ]] && { echo "Error: The variable PEARL_ROOT must be specified in order to run this script."; exit 1; }
[[ -d "$PEARL_ROOT" ]] || { echo "Error: The value in variable PEARL_ROOT is not a directory."; exit 2; }

[[ -z "$KOBOL_VARDIR" ]] && { echo "Error: The variable KOBOL_VARDIR must be specified in order to run this script."; exit 1; }
[[ -d "$KOBOL_VARDIR" ]] || { echo "Error: The value in variable KOBOL_VARDIR is not a directory."; exit 2; }

KOBOL_ROOT="${KOBOL_ROOT:-$(readlink -f $(dirname $(readlink -f "$0"))/..)}"
MAN=man

source $PEARL_ROOT/lib/utils/utils.sh
source "${KOBOL_ROOT}/lib/core.sh"

make_user_mans
$MAN -M ${KOBOL_VARDIR}/mans:${KOBOL_ROOT}/mans/ $@
